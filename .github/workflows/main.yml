name: Auto VPN Pool Refresher

# 触发器配置
on:
  schedule:
    # Cron 表达式：*/10 * * * * 表示每小时的第 0, 10, 20, 30, 40, 50 分钟运行
    - cron: '*/60 * * * *'
  workflow_dispatch: # 允许手动点击按钮测试

jobs:
  refresh:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4
      
      - name: Set up Python 3.9
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      - name: Install Dependencies
        # 需要安装 requests 库来处理 HTTP 请求 (获取订阅和更新 Gist)
        run: pip install requests urllib3

      - name: Run Auto-Sub Script
        # 将 GIST_ID 和 GIST_TOKEN 从 Secrets 传递给脚本作为环境变量
        env:
          GIST_TOKEN: ${{ secrets.GIST_TOKEN }}
          GIST_ID: ${{ secrets.GIST_ID }}
        run: python vpn_refresher.py

